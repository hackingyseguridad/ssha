import socket
import sys

def detectar_vulnerabilidad(ip, puerto):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((ip, puerto))
        sock.sendall(b"SSH-2.0-OpenSSH_7.8p1\r\n")
        respuesta = sock.recv(1024)
        sock.close()

        if b"SSH-2.0-OpenSSH_7.8p1" in respuesta:
            print(f"El host {ip}: {puerto} es vulnerable a CVE-2020-14721")
        else:
            print(f"El host {ip}: {puerto} no es vulnerable a CVE-2020-14721")
    except Exception as e:
        print(f"Error al detectar vulnerabilidad en {ip}: {puerto}: {e}")

if len(sys.argv) != 3:
    print("Uso: python detectar_vulnerabilidad.py <ip> <puerto>")
    sys.exit(1)

ip = sys.argv[1]
puerto = int(sys.argv[2])

detectar_vulnerabilidad(ip, puerto)

